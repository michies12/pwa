$(function(){var e="//va.ecitizen.gov.sg/flexansapi/iras/";$.iras={IITBalMesId1:"28782022",IITBalMesId2:"28781682",IITBalMesId3:"28781447",IITBalMesId4:["39340248","10466855"],maxPrevYears:3,IIT_sess_name:"__IITApiSessId",IIT_year_sess_name:"__IITYear",IIT_auth_only_sess_name:"__IITAuthOnly",IIT_start_txn_sess_name:"__IITStartTxn",IIT_payment_url:e+"RetrieveIP",IIT_req_url:e+"RequestList",IIT_api_url:e+"IncomeTax",IIT_get_tax_url:e+"IncomeTaxBal",IIT_check_token_url:e+"CheckToken",IIT_insert_tax_log_url:e+"InsertTaxBalanceLog",IIT_chat_url:"https://v2.zopim.com/widget/livechat.html?api_calls=%5B%5D&hostname=__www.iras.gov.sg&key=4vCgQdcppbfJwktT1Dk2vZSgK639d7YE&lang=en",updateDetailsUrl:"https://mytax.iras.gov.sg/ESVWeb/default.aspx?target=MPORContactsAlerts&taxtype=101&toLoginSelection=true",assessDetails_url:"https://mytax.iras.gov.sg/ESVWeb/default.aspx?target=MPORCorrespMain&taxtype=101&toLoginSelection=true",nric_input:"",incorrect_nric:0,homepage:!1,iras_efile_url:"https://mytax.iras.gov.sg/ESVWeb/default.aspx",late_filing_penalty_url:"https://mytax.iras.gov.sg/ESVWeb/default.aspx?target=MPYMLCAndSummons&toLoginSelection=true",qnsAsked:"",pay_tax_url:"https://mytax.iras.gov.sg/ESVWeb/default.aspx?target=MPaymentSummary&LHMEntry=True&toLoginSelection=true",apply_giro_url:"https://mytax.iras.gov.sg/ESVWeb/default.aspx?target=MPYMApplyGIROBankDetails&toLoginSelection=true",TopMatchFolderID:0,switch_option:1,tab_activity:0,tabct:0,mainProjectId:8182123},$("body").append('<style>.ui-tooltip { font: 11px "Helvetica Neue", Sans-Serif; }</style>');function G(){$(".speech-bubble1:last").scrollIntoView()}function U(){1==$.iras.switch_option&&($(".ask_cheryl_minimized_tab").trigger("click"),1==$.iras.tab_activity&&($("div.chat_box").animate({right:"-1500px"},300),$(".ask_cheryl_minimized_tab").show(),0==$.iras.tabct&&(t(),$(".ask_cheryl_minimized_tab").trigger("click")),$.iras.tabct=1)),$(".ask_cheryl_minimized_tab").show()}function H(){$(".mdone").show(),"undefined"!=typeof openAuto&&openAuto&&($(".mdone").attr("href","//va.ecitizen.gov.sg/surveys/AskJamie_IRAS IIT/surveyform"),$(".mdone").removeAttr("target"),$(".mdone").removeAttr("onclick")),$(".chat_head .VAclose").css({right:"95px"}),$("img.avatar_img").css("right","120px")}function t(){var e,t=navigator.userAgent,a=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];return/trident/i.test(a[1])?"IE "+((e=/\brv[ :]+(\d+(\.\d+)?)/g.exec(t)||[])[1]||""):(a=a[2]?[a[1],a[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/([\.\d]+)/i))&&(a[2]=e[1]),a.join(" "))}function Q(){"MSIE 7.0"==t()||sessionStorage.setItem("IRASDochtml",$(".avatar_content").html())}-1===window.location.href.indexOf("mobile_combined")&&-1===window.location.href.indexOf("irashome/default.aspx")||($.iras.homepage=!0),$.iras.displayBtnClick=function(e){$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble"><b>You selected:</b><p>Login to SingPass</p></div>'),$(".load").css("display","block")},$.iras.IITMessage1=function(e,t){var a=$.iras.IITSessionIdGen(12),i='<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>'+t+"</p>";return i+='</div><div class="VAclear"></div><div class="speech-bubble1"><form enctype="text/plain" method="post" action="'+$.iras.IIT_api_url+'"><input type="hidden" name="{\'SessionID\':\''+a+"', 'CallBack_url':'"+window.location.href+'\', \'trash\':\'" value="\'}"/><button class="type-3" type="submit" onclick="$.iras.generateIITSession(\''+$.iras.IIT_sess_name+"','"+a+"'); $.iras.genIITAuthOnlyFlag(); $.iras.displayBtnClick(this);\">Login to SingPass</button></form></div>"},$.iras.IITMessage2=function(e){var t=$.iras.IITSessionIdGen(12),a='<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>'+e+"</p>";return a+='</div><div class="VAclear"></div><div class="speech-bubble1"><form enctype="text/plain" method="post" action="'+$.iras.IIT_api_url+'"><input type="hidden" name="{\'SessionID\':\''+t+"', 'CallBack_url':'"+window.location.href+'\', \'trash\':\'" value="\'}"/><button class="type-3" type="submit" onclick="$.iras.generateIITSession(\''+$.iras.IIT_sess_name+"','"+t+"'); $.iras.genIITAuthOnlyFlag(); $.iras.displayBtnClick(this);\">Login to SingPass</button></form></div>"},$.iras.IITMessage3=function(e){var t='<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>'+e+"</p>";if(""===$.iras.getIITSession($.iras.IIT_sess_name)){var a=$.iras.IITSessionIdGen(12);t+='To proceed, please click on "Login to SingPass".</p>',t+='<div style="text-align: center; margin-top: 0px"><form enctype="text/plain" method="post" action="'+$.iras.IIT_api_url+'"><input type="hidden" name="{\'SessionID\':\''+a+"', 'CallBack_url':'"+window.location.href+'\', \'trash\':\'" value="\'}"/><button class="type-3" type="submit" onclick="$.iras.generateIITSession(\''+$.iras.IIT_sess_name+"','"+a+"'); $.iras.genIITAuthOnlyFlag(); $.iras.displayBtnClick(this);\">Login to SingPass</button></form></div></div>"}else{var i=$.iras.IITSessionIdGen(12),s=($.iras.getIITSession($.iras.IIT_sess_name),'<span class="iit-end-session" onclick="$.iras.generateIITSession(\''+$.iras.IIT_sess_name+"','"+i+"'); $.iras.genIITAuthOnlyFlag(); $(this).closest('div').find('form').submit();\" style=\"cursor: pointer; text-decoration: underline\">click here</span>"),n='<form method="post" action="'+$.iras.IIT_api_url+'" enctype="text/plain">';n+="<input type=\"hidden\" name=\"{'SessionID':'"+a+"', 'CallBack_url':'"+window.location.href+"', 'trash':'\" value=\"'}\"/>",t+=n+="</form>",t+="To proceed to do so, please "+s+" to end the current session."}$.iras.appendIITMsg(t)},$.iras.IITMessage4=function(e){var t=$.iras.IITSessionIdGen(12),a='<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>'+e+"</p>";return a+='</div><div class="VAclear"></div><div class="speech-bubble1"><form enctype="text/plain" method="post" action="'+$.iras.IIT_api_url+'"><input type="hidden" name="{\'SessionID\':\''+t+"', 'CallBack_url':'"+window.location.href+'\', \'trash\':\'" value="\'}"/><button class="type-3" type="submit" onclick="$.iras.generateIITSession(\''+$.iras.IIT_sess_name+"','"+t+"'); $.iras.genIITAuthOnlyFlag(); $.iras.displayBtnClick(this);\">Login to SingPass</button></form></div>"},$.iras.appendIITMsg=function(e){0<$(".avatar_content > ul > li").length?$(".avatar_content > ul > li:last").append(e):($(".avatar_content > ul").append("<li></li>"),$(".avatar_content > ul > li").append(e)),G(),Q()},$.iras.IITDisplayOutofRangeMsg=function(){var e='<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>We can only check on records up to '+$.iras.maxPrevYears+" back years. Please try again.</p>";e+="</div>",$.iras.appendIITMsg(e)},$.iras.checkTokenLC=function(e){if(""!=e){$(".load").css("display","block");var t={SessionId:e,CallBack_url:""};$.ajax({url:$.iras.IIT_check_token_url,data:JSON.stringify(t),method:"POST",contentType:"text/plain",success:function(e){var t;t=e,$(".chatbutton").css("display","block"),$(".load").css("display","none"),$zopim(function(){$zopim.livechat.setOnConnected(function(){58976==$.iras.TopMatchFolderID?"offline"==$zopim.livechat.departments.getDepartment("IIT (Late and Non-filing or payment)").status?($zopim.livechat.window.show(),$zopim.livechat.setStatus("offline")):($zopim.livechat.departments.filter("IIT (Late and Non-filing or payment)"),$zopim.livechat.departments.setVisitorDepartment("IIT (Late and Non-filing or payment)"),$zopim.livechat.window.show(),0==$zopim.livechat.isChatting()&&(conversation=$.iras.qnsAsked,conversation="true"==t||1==t?"User has authenticated with SingPass. "+conversation:"User has not authenticated with SingPass. "+conversation,$zopim.livechat.say(conversation))):"offline"==$zopim.livechat.departments.getDepartment("Individual Income Tax").status?($zopim.livechat.window.show(),$zopim.livechat.setStatus("offline")):($zopim.livechat.departments.filter("Individual Income Tax"),$zopim.livechat.departments.setVisitorDepartment("Individual Income Tax"),$zopim.livechat.window.show(),0==$zopim.livechat.isChatting()&&(conversation=$.iras.qnsAsked,conversation="true"==t||1==t?"User has authenticated with SingPass. "+conversation:"User has not authenticated with SingPass. "+conversation,$zopim.livechat.say(conversation))),jQuery.browser.mobile||U()})})}})}else G()},$.iras.checkToken=function(t,a,i,s){if(""!=t){var e={SessionId:t,CallBack_url:""};$.ajax({url:$.iras.IIT_check_token_url,data:JSON.stringify(e),method:"POST",contentType:"text/plain",success:function(e){processTokenResp(e,t,i,s,a)}})}else G()},$.iras.getIITSession=function(e){var t=sessionStorage.getItem(e);return void 0!==t&&""!==t&&null!==t?sessionStorage.getItem(e):""},$.iras.deleteIITSession=function(e){sessionStorage.removeItem(e)},$.iras.generateIITSession=function(e,t){"undefined"!=typeof Storage&&sessionStorage.setItem(e,t)},$.iras.disableSpLogout=function(){0<$("div.text_chat").find("button.btnSpLogout").length&&($("div.text_chat").find("button.btnSpLogout").remove(),$(".send_button").attr("style","display: inline-block; padding: 4px 10px !important; float: right; right: 20px"))},$.iras.genIITAuthOnlyFlag=function(){$.iras.generateIITSession($.iras.IIT_auth_only_sess_name,"1")},$.iras.genIITStartTxnFlag=function(){$.iras.generateIITSession($.iras.IIT_start_txn_sess_name,"1")},$.iras.nric_ya_form_html=function(e,t){void 0===e&&(e="");var a=moment().format("YYYY"),i=moment().subtract("1","years").format("YYYY"),s='<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>Please enter the year of assessment (YA) that you are checking on and last 3 digits of your NRIC/FIN followed by the alphabet.</p>';return s+='<form class="iit-form" data-parsley-validate="">',s+='<div style="margin-top: 10px">',s+='<div style="width: 100%"><label class="label-input">YA</label> <input type="text" data-parsley-range="'+$.iras.getYearRange()+'" data-parsley-range-message="Error: We can only check on records up to '+$.iras.maxPrevYears+' back years. Please re-enter the YA." data-parsley-required-message="YA is a required field" data-parsley-type-message="Please enter only numbers for YA." data-parsley-type="integer" data-parsley-required maxlength="4" style="display: inline-block; padding: 5px; width: 75px" name="IIT_year_input" value="'+t+'"/> <div class="label-year">E.g. enter '+a+" if you are checking on assessment status for income earned in "+i+"</div></div>",s+='<div style="margin-top: 5px; width: 100%"><label class="label-input">NRIC/FIN</label> <input data-parsley-type="alphanum" data-parsley-pattern="[0-9]{3}[a-zA-Z]{1}" data-parsley-pattern-message="Error: Please re-enter the NRIC/FIN in the correct format." data-parsley-required data-parsley-required-message="NRIC/FIN is a required field" data-parsley-type-message="Error: Please re-enter the NRIC/FIN in the correct format." value="'+e+'" maxlength="4" style="display: inline-block; padding: 5px; width: 75px;" type="text" name="IIT_nric_input"/> <div class="label-nric">E.g. SXXXX123A, please enter <u>123A</u>.</div></div>',s+="</div>",s+='<div class="form-iit-btn"><button type="button" class="type-3 enquireITB">Enquire</button></div>',s+='<div style="width: 100%" class="iit-validation-msg"></div>',s+="</form></div>"},$.iras.detectYear=function(e){var t=new RegExp(/(\d){2,4}/g),a=e.match(t),i=moment().format("YYYY");if(null!==a)if(a[0]&&1===a.length)switch(a[0].length){case 2:i=1<=parseInt(a[0])&&parseInt(a[0])<=70?2e3+parseInt(a[0]):1e3+parseInt(a[0]);break;case 3:900<=parseInt(a[0])&&parseInt(a[0])<=999&&(i=1e3+parseInt(a[0])),1<=parseInt(a[0])&&parseInt(a[0])<=99&&(i=2e3+parseInt(a[0]));break;case 4:i=a[0]}else{var s=a.reduce(function(e,t){return Math.max(e,t)});if(s)return s}return i},$.iras.validateYearRange=function(e){var t=moment().format("YYYY");return!(t<e||e<t-$.iras.maxPrevYears)},$.iras.getYearRange=function(){var e=moment().format("YYYY");return"["+(e-$.iras.maxPrevYears)+", "+e+"]"},$.iras.checkITB=function(e,t,a,i){var s={SessionID:e,Year:t,UserID:a.toUpperCase()};$(".avatar_content > ul > li:last form.iit-form:last").find("div.iit-validation-msg ul li.parsley-nric").remove();$.ajax({url:$.iras.IIT_get_tax_url,data:JSON.stringify(s),method:"POST",contentType:"text/plain",crossDomain:!0,success:function(e){processIITResp(e,a,t,i,!1)},statusCode:{400:function(e){$(".load").css("display","none"),$.iras.disableIITForm(),$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>An error occurred on the server. Please try again later.</p><p>'+$.iras.displayErrorLiveChatMsg()+"</p></div>")},500:function(e){$(".load").css("display","none"),$.iras.disableIITForm(),$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>An error occurred on the server. Please try again later.</p><p>'+$.iras.displayErrorLiveChatMsg()+"</p></div>")},404:function(e){$(".load").css("display","none"),$.iras.disableIITForm(),$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>An error occurred on the server. Please try again later.</p><p>'+$.iras.displayErrorLiveChatMsg()+"</p></div>")}}})},$.iras.promptIITInputForm=function(e,t){$.iras.appendIITMsg($.iras.nric_ya_form_html(e,t));var i=$(".avatar_content > ul > li:last").find("form.iit-form:last"),s=i.find('input[name="IIT_year_input"]').parsley(),n=i.find('input[name="IIT_nric_input"]').parsley();i.on("click",".enquireITB",function(){i.parsley().whenValidate().done(function(){var e=i.find('input[name="IIT_nric_input"]').val(),t=i.find('input[name="IIT_year_input"]').val(),a=$.iras.getIITSession($.iras.IIT_sess_name);return $(".load").css("display","block"),$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble"><b>You clicked:</b><br/>Enquire</div>'),$.iras.checkITB(a,t,e,2),!1})});var r=i;i.parsley().on("form:validated",function(e){if(!1===s.isValid()){var t=r.find('input[name="IIT_year_input"]').next("ul").detach();r.find("div.iit-validation-msg").append(t)}if(!1===n.isValid()){var a=r.find('input[name="IIT_nric_input"]').next("ul").detach();r.find("div.iit-validation-msg").append(a)}}),G()},processTokenResp=function(e,t,a,i,s){!1===e||"false"===e?"1"==$.iras.getIITSession($.iras.IIT_auth_only_sess_name)||"1"==$.iras.getIITSession($.iras.IIT_start_txn_sess_name)?($.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>Your previous login attempt was cancelled or ended with an error. Please try again later.</p></div>'),"1"==$.iras.getIITSession($.iras.IIT_auth_only_sess_name)&&$.iras.deleteIITSession($.iras.IIT_auth_only_sess_name),"1"==$.iras.getIITSession($.iras.IIT_start_txn_sess_name)&&$.iras.deleteIITSession($.iras.IIT_start_txn_sess_name)):a&&($.iras.showTimeoutMessage("","",1),$.iras.disableSpLogout()):(H(),0===$("div.text_chat").find("button.btnSpLogout").length&&($("div.text_chat").append('&nbsp;<button title="Logout of active SingPass session" type="button" class="btnSpLogout">Logout</button>'),jQuery.browser.mobile?($(".text_chat textarea").css("width","72%"),$(".send_button, .btnSpLogout").attr("style","display: inline-block; padding: 4px 5px !important; top: 0px; float: none; right: 0px")):$(".send_button, .btnSpLogout").attr("style","display: inline-block; padding: 4px 5px !important; float: none; right: 0px"),$(".btnSpLogout").tooltip(),$(".btnSpLogout").off().on("click",function(){$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble"><b>You clicked:</b><p>Logout</p></div>'),$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says</strong><p>You have successfully logged out of SingPass.</p></div>'),$.iras.deleteIITSession($.iras.IIT_sess_name),$.iras.disableIITForm(),$("div.text_chat").find("button.btnSpLogout").off().remove(),0<$(".ui-tooltip").length&&$(".btnSpLogout").tooltip("destroy"),$(".send_button").removeAttr("style"),$(".send_button").attr("style","display: inline-block"),jQuery.browser.mobile&&$(".text_chat textarea").css("width","80%")})),s&&"1"==$.iras.getIITSession($.iras.IIT_auth_only_sess_name)?$.iras.promptIITInputForm($.iras.nric_input,i):"1"==$.iras.getIITSession($.iras.IIT_start_txn_sess_name)?$.iras.checkITB(t,"","",2):a&&$.iras.promptIITInputForm($.iras.nric_input,i),"1"==$.iras.getIITSession($.iras.IIT_auth_only_sess_name)&&$.iras.deleteIITSession($.iras.IIT_auth_only_sess_name),"1"==$.iras.getIITSession($.iras.IIT_start_txn_sess_name)&&$.iras.deleteIITSession($.iras.IIT_start_txn_sess_name),$.iras.getIITSession($.iras.IIT_year_sess_name)&&$.iras.deleteIITSession($.iras.IIT_year_sess_name)),Q(),G()},processIITResp=function(e,g,h,I,b,t){if($(".load").css("display","none"),"string"==typeof e){if("no token"===e.toLowerCase())return $.iras.showTimeoutMessage(g,h,I),$.iras.disableIITForm($(".avatar_content > ul > li:last").find("form.iit-form:last")),$.iras.disableSpLogout(),G(),void Q();e=(e=e.replace(/\'/g,'"')).replace(/\\/g,"")}if($.iras.nric_input=g,"object"!=typeof e)var a=JSON.parse(e);else a=e;var _="",x="",i=parseInt(a.returnCode);if(void 0!==i&&i){if(void 0===(s=a.Info))var s=a.info;var n=parseInt(s.messageCode)}else _="<p>Sorry, there seems to be an error retrieving your individual income tax information. "+$.iras.displayErrorLiveChatMsg()+"</p>";var r=!1,T=!1,o=!1;if(a.data){var l=a.data.returnstatus,w=a.data.outstandingBalance,c=(a.data.paymentByGiro,a.data.paymentDueDate);if(void 0!==w?-1!==w.indexOf(",")&&(w=w.replace(",","")):w=0,null!==c){for(var d=c.split("|"),Y="",p=0;p<d.length;p++){var u=d[p].trim(),m=moment(u.substring(0,u.indexOf(",")).trim(),"DD-MM-YYYY"),f=parseFloat(u.substring(u.indexOf(",")+1).trim());f=parseFloat(f).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),Y+=0==p?"$"+f+" is due on "+m.format("DD/MM/YYYY"):", $"+f+" is due on "+m.format("DD/MM/YYYY")}Y+="."}else Y=""}var v=$(".avatar_content > ul > li:last").find("form.iit-form:last"),y=parseInt(moment().format("YYYY")),S=!1;switch(moment().isBefore(moment("15-03-"+y,"DD-MM-YYYY"))&&(S=!0),i){case 30:switch(n){case 850301:if($.iras.incorrect_nric+=1,3!==$.iras.incorrect_nric)return $(v).find('input[name="IIT_nric_input"]').focus(),void $(v).find("div.iit-validation-msg").append('<ul class="parsley-errors-list filled"><li class="parsley-nric">Sorry, the NRIC/FIN you entered is different from the login ID. Please re-enter the NRIC/FIN.</li></ul>');var k=$.iras.IITSessionIdGen(12),A='<span class="iit-end-session" onclick="$.iras.generateIITSession(\''+$.iras.IIT_sess_name+"','"+k+"'); $.iras.genIITAuthOnlyFlag(); $(this).closest('div').find('form').submit();\" style=\"cursor: pointer; text-decoration: underline\">click here</span>",F='<form method="post" action="'+$.iras.IIT_api_url+'" enctype="text/plain">';F+="<input type=\"hidden\" name=\"{'SessionID':'"+k+"', 'CallBack_url':'"+window.location.href+"', 'trash':'\" value=\"'}\"/>",_="Sorry, the NRIC/FIN you entered is different from the login ID. Please "+A+" to login using your Singpass.",_+=F+="</form>",$.iras.incorrect_nric=0;break;case 850302:case 850303:_="<p>Sorry, there seems to be an error retrieving your individual income tax information. "+$.iras.displayErrorLiveChatMsg()+"</p>";break;case 850304:_="<p>Sorry, there is an error with your request. Please login again.</p>"}break;case 10:if(void 0===(M=a.data.NOADate))var M=a.data.noaDate;var D=a.data.filingDueDate;switch(l.toLowerCase()){case"posted":D=a.data.filingDueDate,0<w||0<Math.abs(w)?(w=parseFloat(w).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),_=void 0===M?"<p>We have finalized your tax bill for the Year of Assessment "+h+".</p>":"<p>We have finalized your tax bill for the Year of Assessment "+h+" dated "+M+".</p>",r=!0,x+="<p>To view your assessment details, click here to login to myTax Portal:",x+='<div style="margin: 8px; text-align: center; width: 100%;"><button onclick="window.open(\''+$.iras.assessDetails_url+'\');" type="button" class="btn-iit">Notices/Letters</button></div></p>'):(_=void 0===M?"<p>We have finalized your tax bill for the Year of Assessment "+h+". ":"<p>We have finalized your tax bill for the Year of Assessment "+h+" dated "+M+". ",_+="You do not have any outstanding tax.</p>",_+="To view your assessment details, click here to login to myTax Portal:",_+='<div style="margin: 8px; text-align: center; width: 100%;"><button onclick="window.open(\''+$.iras.assessDetails_url+'\');" type="button" class="btn-iit">Notices/Letters</button></div></p>');break;case"issued":var P=moment(),L=a.data.filingFormType;if(D=a.data.filingDueDate,void 0===L||!L)L="";switch(L.toLowerCase()){case"form m":S||parseInt(h)!==y?parseInt(h)!==y?(_="<p>We have not received your tax filing for Year of Assessment "+h+" which was due on "+D+". Please file your paper tax return immediately.",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" data-request-type="2" class="btnRequestForm btn-iit">Request for tax form</button></div>',_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" class="btn-iit" onclick="window.open(\''+$.iras.late_filing_penalty_url+"');\">Check on my late filing penalty</button></div></p>",T=r=!0):S&&parseInt(h)===y&&(_="<p>You are required to do your filing for this year. You can expect to receive your tax form latest by 15 Mar. Please submit it by 15 Apr "+h+" to avoid any late filing fees.</p>",r=!0):T=r=(P.isAfter(moment(D,"DD-MM-YYYY"))?(_="<p>We have not received your tax filing for Year of Assessment "+h+" which was due on "+D+". Please file your paper tax return immediately.",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" data-request-type="2" class="btnRequestForm btn-iit">Request for tax form</button></div>',_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" class="btn-iit" onclick="window.open(\''+$.iras.late_filing_penalty_url+"');\">Check on my late filing penalty</button></div></p>"):(_="<p>We have not received your tax filing for Year of Assessment "+h+". Please submit your paper tax return by "+D+" to avoid any late filing fees.",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" data-request-type="2" class="btnRequestForm btn-iit">Request for tax form</button></div></p>'),!0);break;case"form b":case"form b1":case"form b/b1":case"":var q=moment(D,"DD-MM-YYYY");parseInt(h)===y?P.isBefore(q)?P.isBetween(h+"-03-01",h+"-11-15",null,"[]")?(_="<p>We have not received your tax filing for Year of Assessment "+h+". Please e-file your tax return by "+D+" to avoid any late filing fees.</p>",r=!0):P.isBetween(h+"-01-01",h+"-02-28",null,"[]")||P.isBetween(h+"-01-01",h+"-02-29",null,"[]")?(_="<p>You are required to do your filing for this year. You may e-file from 1 Mar to 18 Apr via myTax Portal.</p>",r=!0):P.isAfter(h+"-11-15")&&(_="<p>You are required to do your filing for this year. You may e-file from 1 Mar to 18 Apr via myTax Portal.</p>",r=!0):P.isAfter(h+"-11-15")?(_="<p>We have not received your tax filing for Year of Assessment "+h+" which was due on "+D+". Please file your paper tax return immediately.",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" data-request-type="2" class="btnRequestForm btn-iit">Request for tax form</button></div>',_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" onclick="window.open(\''+$.iras.late_filing_penalty_url+'\');" class="btn-iit">Check on my late filing penalty</button></div></p>',T=r=!0):P.isBetween(h+"-04-19",h+"-11-15",null,"[]")?(_="<p>We have not received your tax filing for Year of Assessment "+h+" which was due on "+D+". Please e-file your tax return immediately.",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" onclick="window.open(\''+$.iras.iras_efile_url+'\');" class="btn-iit">E-file my tax</button></div>',_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" onclick="window.open(\''+$.iras.late_filing_penalty_url+'\');" class="btn-iit">Check on my late filing penalty</button></div></p>',r=!0):void 0!==D&&D||(_="<p>You are required to do your filing for this year. You may e-file from 1 Mar to 18 Apr via myTax Portal.</p>",r=!0):P.isBefore(q)?(_="<p>We have not received your tax filing for Year of Assessment "+h+". Please submit your paper tax return by "+D+" to avoid any late filing fees.</p>",r=!0):(_="<p>We have not received your tax filing for Year of Assessment "+h+" which was due on "+D+". Please file your paper tax return immediately.",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" data-request-type="2" class="btnRequestForm btn-iit">Request for tax form</button></div>',_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" onclick="window.open(\''+$.iras.late_filing_penalty_url+'\');" class="btn-iit">Check on my late filing penalty</button></div></p>',T=r=!0)}break;case"suppressed":case"no return status":case"return status not in the list":_="<div>We did not issue you any tax return for the Year of Assessment "+h+'.</div><div style="margin-top: 15px">Generally, an individual is required to file a tax return if the annual income exceeds $22,000. For a self-employed, he/she is required to file a tax return if the annual net trade income exceeds $6,000.</div>',r=!0;break;case"received":case"data captured":case"datacapt":case"underreview":case"under review":P=moment();parseInt(h)===y?P.isBetween(h+"-10-01",h+"-12-31",null,"[]")?(_="<p>We have received your tax filing for the Year of Assessment "+h+" and are in the midst of processing your tax bill. You can expect to receive the tax bill in 1 month's time.</p>",o=r=!0):P.isBetween(h+"-01-01",h+"-09-30",null,"[]")&&(_="<p>We have received your tax filing for the Year of Assessment "+h+" and are in the midst of processing your tax bill. Generally, taxpayers should expect to receive their tax bills between May to Sep.</p>",r=!0):(_="<p>We have received your tax filing for the Year of Assessment "+h+" and are in the midst of processing your tax bill. You can expect to receive the tax bill in 1 month's time.</p>",o=r=!0);break;case"not required":case"notreqd":var C=a.data.filingFormType,B=a.data.filingFormPackage;P=moment();if(-1!==B.toLowerCase().indexOf("nrnf"))-1!==C.toLowerCase().indexOf("form b1")?parseInt(h)===y?P.isBetween(h+"-01-01",h+"-02-28",null,"[]")||P.isBetween(h+"-01-01",h+"-02-29",null,"[]")?(_="<p>You have been selected for <i>No Filing Service</i> for Year of Assessment "+h+". You may preview your tax bill from 1 Mar in myTax Portal and if you have any changes, you may e-file by "+D+". Alternatively, you may raise an objection via myTax portal after you receive your tax bill.</p>",r=!0):P.isBetween(h+"-03-01",D,null,"[]")?(_="<p>You have been selected for <i>No Filing Service</i> for Year of Assessment "+h+". You may preview your tax bill in myTax Portal and if you have any changes, you may e-file by "+D+". Alternatively, you may raise an objection via myTax portal after you have received your tax bill.",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" class="btn-iit" onclick="window.open(\''+$.iras.iras_efile_url+"');\">Preview my tax bill</button></div></p>",r=!0):P.isAfter(moment(D,"DD-MM-YYYY"))&&(_="<p>You have been selected for <i>No Filing Service</i> for Year of Assessment "+h+". We are in the midst of processing your tax bill. You can expect to receive the tax bill in 1 month's time.</p>",r=!0):(_="<p>You have been selected for <i>No Filing Service</i> for Year of Assessment "+h+". </p><p>We are in the midst of processing your tax bill. You can expect to receive the tax bill in 1 month's time.</p>",r=!0):(_="<p>You have been selected for <i>No Filing Service</i> for Year of Assessment "+h+". If you disagree with the rental statement or has other income to declare, you may provide the details in the enclosed annex and submit to us.",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" data-request-type="3" class="btn-iit btnRequestForm">Request for annex</button></div></p>',T=r=!0);else if(parseInt(h)===y)if(P.isBetween(h+"-01-01",h+"-02-28",null,"[]")||P.isBetween(h+"-01-01",h+"-02-29",null,"[]"))_="<p>You are not required to file a tax return for Year of Assessment "+h+".<br/><br/>Generally, an individual is required to file a tax return if the annual income exceeds $22,000. For a self-employed, he/she is required to file a tax return if the annual net trade income exceeds $6,000.</p>",_+="<p>If your income exceed the filing threshold, you may e-file from 1 Mar to 18 Apr via myTax Portal.</p>",r=!0;else if(P.isBetween(h+"-03-01",h+"-04-18",null,"[]"))_="<p>You are not required to file a tax return for Year of Assessment "+h+".<br/><br/>Generally, an individual is required to file a tax return if the annual income exceeds $22,000. For a self-employed, he/she is required to file a tax return if the annual net trade income exceeds $6,000.</p>",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" class="btn-iit" onclick="window.open(\''+$.iras.iras_efile_url+"');\">Yes, I need to file as my income exceeds the filing threshold</button></div></p>",r=!0;else if(P.isBetween(h+"-04-19",h+"-11-15",null,"[]"))if($.iras.checkAfterHours())_="<p>We will need to have further check on your query. You may chat with our live chat agents or call us at 1800-356-8300 during office hours from 8am to 5pm.</p>";else{var R="";void 0!==(V=$.iras.getIITSession($.iras.IIT_sess_name))&&V&&(R+="&spsessid="+V),event.stopPropagation(),event.stopImmediatePropagation(),U();var O=$.iras.homepage?"window.open('//va.ecitizen.gov.sg/CFP/VA/IRAS/chat.html?projectid="+$.iras.mainProjectId+R+"', '','width=370,height=470,scrollbars=yes,toolbar=no,directories=no,status=no,menubar=no,resizable=no');":"$.iras.checkTokenLC('"+V+"');";_='<p>We will need to have further check on your query. Please <span onclick="'+O+'" style="text-decoration: underline; cursor: pointer">click here</span> to chat with our live chat agents.</p>'}else P.isAfter(moment(h+"-11-15","YYYY-MM-DD"))&&(_="<p>You are not required to file a tax return for Year of Assessment "+h+".<br/><br/>Generally, an individual is required to file a tax return if the annual income exceeds $22,000. For a self-employed, he/she is required to file a tax return if the annual net trade income exceeds $6,000.</p>",_+="<p>If your income exceed the filing threshold, please request and submit the tax form within 21 days from the date on the form.</p>",_+='<div style="margin: 8px; text-align: center; width: 100%"><button type="button" data-request-type="2" class="btnRequestForm btn-iit">Request for tax form</button></div></p>',T=r=!0);else if($.iras.checkAfterHours())_="<p>We will need to have further check on your query. You may chat with our live chat agents or call us at 1800-356-8300 during office hours from 8am to 5pm.</p>";else{R="";void 0!==(V=$.iras.getIITSession($.iras.IIT_sess_name))&&V&&(R+="&spsessid="+V);O=$.iras.homepage?"window.open('//va.ecitizen.gov.sg/CFP/VA/IRAS/chat.html?projectid="+$.iras.mainProjectId+R+"', '','width=370,height=470,scrollbars=yes,toolbar=no,directories=no,status=no,menubar=no,resizable=no');":"$.iras.checkTokenLC('"+V+"');";_='<p>We will need to have further check on your query. Please <span onclick="'+O+'" style="text-decoration: underline; cursor: pointer">click here</span> to chat with our live chat agents.</p>'}break;default:if($.iras.checkAfterHours())_="<p>We will need to have further check on your query. You may chat with our live chat agents or call us at 1800-356-8300 during office hours from 8am to 5pm.</p>";else{var V;R="";void 0!==(V=$.iras.getIITSession($.iras.IIT_sess_name))&&V&&(R+="&spsessid="+V);O=$.iras.homepage?"window.open('//va.ecitizen.gov.sg/CFP/VA/IRAS/chat.html?projectid="+$.iras.mainProjectId+R+"', '','width=370,height=470,scrollbars=yes,toolbar=no,directories=no,status=no,menubar=no,resizable=no');":"$.iras.checkTokenLC('"+V+"');";_='<p>We will need to have further check on your query. Please <span onclick="'+O+'" style="text-decoration: underline; cursor: pointer">click here</span> to chat with our live chat agents.</p>'}}}if(o){var N={SessionID:W=$.iras.getIITSession($.iras.IIT_sess_name),UserID:g.toUpperCase(),RequestType:"1||"+h,TaxType:"IIT"};$.ajax({url:b?json_url:$.iras.IIT_req_url,data:b?"":JSON.stringify(N),method:b?"GET":"POST",contentType:"text/plain",success:function(e){if($(".load").css("display","none"),"string"==typeof e){if("no token"===e.toLowerCase())return $.iras.showTimeoutMessage(g,h,I),$.iras.disableIITForm($(".avatar_content > ul > li:last").find("form.iit-form:last")),$.iras.disableSpLogout(),G(),void Q();e=(e=e.replace(/\'/g,'"')).replace(/\\/g,"")}}})}var z="";if(r){var W=$.iras.getIITSession($.iras.IIT_sess_name);N={UserID:g.toUpperCase(),TaxType:"IIT",SessionID:W};if(b){var E="GET",J=t;N={}}else E="POST",J=$.iras.IIT_payment_url;$(".load").css("display","block"),$.ajax({url:J,data:b?"":JSON.stringify(N),method:E,contentType:"text/plain",success:function(e){if($(".load").css("display","none"),"string"==typeof e){if("no token"===e.toLowerCase())return $.iras.showTimeoutMessage(g,h,I),$.iras.disableIITForm($(".avatar_content > ul > li:last").find("form.iit-form:last")),$.iras.disableSpLogout(),G(),void Q();e=(e=e.replace(/\'/g,'"')).replace(/\\/g,"")}if("object"!=typeof e)var t=JSON.parse(e);else t=e;switch(parseInt(t.returnCode)){case 10:var a=t.data.ipStatus,i=t.data.refundStatus,s=parseFloat(t.data.ipAmount),n=parseFloat(t.data.pipAmount),r=parseFloat(t.data.backYearAmount),o=t.data.ipDetails;if(void 0!==w?-1!==w.indexOf(",")&&(w=w.replace(",","")):w=0,outstandingBaldisplay=parseFloat(w).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),pipAmountdisplay=parseFloat(n).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),ipAmountdisplay=parseFloat(s).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),backYearAmountdisplay=parseFloat(r).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),null!==a&&"active"==a.toLowerCase()){if(0<n&&n<s){var l=t.data.instalmentProvDate;moment(l,"DD-MM-YYYY").format("YYYY");z+='<span class="iit-checkbalance"><p>You are currently paying your tax of $'+backYearAmountdisplay+" (outstanding tax of $"+outstandingBaldisplay+" + provisional tax of $"+pipAmountdisplay+" for YA "+h+") via GIRO.</p></div>",z+='<div class="VAclear"></div><div class="speech-bubble1"><span class="iit-checkbalance"><p>Your instalment plan is as follows:<br/>',z+="<table><tbody>";for(var c=o.split("|"),d=0;d<c.length;d++){var p=c[d].trim(),u=moment(p.substring(0,p.indexOf(",")-1).trim(),"MMDDYY"),m=parseFloat(p.substring(p.indexOf(",")+1).trim());m=parseFloat(m).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),z+="<tr>",z+="<td>"+u.format("MMM 'YY")+"</td>",z+="<td>$"+m+"</td>",z+="</tr>"}z+="</tbody></table></p></span>"}else if(0<n&&s==n){var f=h;z+="<table><tbody>";for(c=o.split("|"),d=0;d<c.length;d++){p=c[d].trim(),u=moment(p.substring(0,p.indexOf(",")-1).trim(),"MMDDYY"),m=parseFloat(p.substring(p.indexOf(",")+1).trim());m=parseFloat(m).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),0==d&&(f=u.format("YYYY")),z+="<tr>",z+="<td>"+u.format("MMM 'YY")+"</td>",z+="<td>$"+m+"</td>",z+="</tr>"}if(z+="</tbody></table></p></span>",w<=0)var v="You do not have any outstanding taxes. ";else v="";z='<span class="iit-checkbalance"><p>'+v+"You are currently paying your provisional tax of $"+pipAmountdisplay+" for YA "+f+' via GIRO.</p></span></div><div class="VAclear"><div class="speech-bubble1"><span class="iit-checkbalance"><p>Your provisional instalment plan is as follows:<br/>'+z}else if(0<s){z+='<span class="iit-checkbalance"><p>You are currently paying your outstanding tax of $'+outstandingBaldisplay+" via GIRO.<p><p>Your current instalment plan is as follows: <br/>",z+="<table><tbody>";for(c=o.split("|"),d=0;d<c.length;d++){p=c[d].trim(),u=moment(p.substring(0,p.indexOf(",")-1).trim(),"MMDDYY"),m=parseFloat(p.substring(p.indexOf(",")+1).trim());m=parseFloat(m).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),z+="<tr>",z+="<td>"+u.format("MMM 'YY")+"</td>",z+="<td>$"+m+"</td>",z+="</tr>"}z+="</tbody></table></p></span>"}}else void 0!==w?-1!==w.indexOf(",")&&(w=w.replace(",","")):w=0,outstandingBaldisplay=parseFloat(Math.abs(w)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),0==parseFloat(w)?z+="<p>You do not have any outstanding taxes.</p>":parseFloat(w)<10&&0<w?z+="<p>Your current outstanding tax is $"+outstandingBaldisplay+". As the amount is less than $10, no payment is required. The amount will be carried forward to next bill.</p>":10<=parseFloat(w)?(z+="<p>Your current outstanding tax is $"+outstandingBaldisplay+".</p>",z+="<p>"+Y+"</p>",z+="<p>To pay your outstanding tax or to apply for GIRO, click here to login to myTax Portal: ",z+='<div style="margin-top: 10px; text-align: center; width: 100%">',z+='<button type="button" class="btn-iit" onclick="window.open(\''+$.iras.pay_tax_url+'\');">Pay Taxes</button> &nbsp; <button type="button" class="btn-iit" onclick="window.open(\''+$.iras.apply_giro_url+"');\">Apply GIRO</button>",z+="</div></p>"):-15<parseFloat(w)?z+="<p>You have a credit balance of $"+outstandingBaldisplay+" which will be used to offset against future taxes.</p>":parseFloat(w)<=-15&&(-1!==i.toLowerCase().indexOf("approve")?z+="<p>You have a credit balance of $"+outstandingBaldisplay+" which you will receive the refund into your GIRO account within 30 days from the date the refund arises.</p>":z+="<p>You have a credit balance of $"+outstandingBaldisplay+". Generally, the refund will be processed within 30 days via cheque from the date the refund arises.</p>")}var y=_+z+x;$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><span class="iit-checkbalance">'+y+"</span></div>"),T&&bindBtnRequestForm(g,h,1,$.iras.getIITSession($.iras.IIT_sess_name),b),H(),$.iras.disableIITForm($(".avatar_content > ul > li:last").find("form.iit-form:last")),G(),$.iras.insertTaxBalanceLog(g,h,$.iras.getIITSession($.iras.IIT_sess_name)),Q()},statusCode:{404:function(e){$(".load").css("display","none"),$.iras.disableIITForm()}}})}else{var j=_+z+x;$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><span class="iit-checkbalance"><p>'+j+"</p></span></div>"),T&&bindBtnRequestForm(g,h,1,$.iras.getIITSession($.iras.IIT_sess_name)),H(),$.iras.disableIITForm($(".avatar_content > ul > li:last").find("form.iit-form:last")),G(),$.iras.insertTaxBalanceLog(g,h,$.iras.getIITSession($.iras.IIT_sess_name)),Q()}},$.iras.insertTaxBalanceLog=function(e,t,a){var i={SessionID:a,Year:t,Nric:e.toUpperCase()};$.get($.iras.IIT_insert_tax_log_url,i,function(e){})},$.iras.disableIITForm=function(e){$.iras.incorrect_nric=0,e?(e.find("input").attr("disabled","disabled"),e.find("button.btn-iit").attr("disabled","disabled"),e.find("button.type-3").attr("disabled","disabled"),e.find("button.type-3").attr("onclick",""),e.unbind("click",".enquireITB"),e.parsley().destroy(),e.find("ul.parsley-errors-list").remove(),e.removeClass("iit-form")):($(".avatar_content ul form.iit-form input").attr("disabled","disabled"),$(".avatar_content ul form.iit-form button.btn-iit").attr("disabled","disabled"),$(".avatar_content ul form.iit-form button.type-3").attr("disabled","disabled"),$(".avatar_content ul button.btn-iit").attr("disabled","disabled"),$(".avatar_content ul button.type-3").attr("disabled","disabled"),$(".avatar_content ul button.type-3").attr("onclick",""),$(".avatar_content ul form.iit-form").unbind("click",".enquireITB"),$(".avatar_content ul form.iit-form").each(function(e,t){$(t).parsley().destroy()}),$(".avatar_content ul form.iit-form ul.parsley-errors-list").remove(),$(".avatar_content ul form.iit-form").removeClass("iit-form"))},$.iras.showTimeoutMessage=function(e,t,a){var i=$.iras.IITSessionIdGen(12),s="<input type=\"hidden\" name=\"{'SessionID':'"+i+"', 'CallBack_url':'"+window.location.href+"', 'trash':'\" value=\"'}\"/>",n=1==a?"$.iras.genIITAuthOnlyFlag(); $.iras.displayBtnClick(this);":"$.iras.genIITStartTxnFlag(); $.iras.displayBtnClick(this);",r='<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><p>As the earlier session has expired, please login via your SingPass for us to check on your enquiry.</p>'+('<div style="text-align: center; width: 100%"><form method="post" action="'+$.iras.IIT_api_url+'" enctype="text/plain">'+s+'<button class="type-3" type="submit" onclick="$.iras.generateIITSession(\''+$.iras.IIT_sess_name+"','"+i+"'); "+n+'">Login to SingPass</button></form></div>')+"</div>";$.iras.appendIITMsg(r)},$.iras.IITSessionIdGen=function(e){return(Math.random().toString(36).substr(2)+Math.random().toString(36).substr(2)).substr(0,e-1)},$.iras.checkAfterHours=function(){return!(1<=moment().day()&&moment().day()<=5)||!1==(8<=parseInt(moment().format("H"))&&parseInt(moment().format("H"))<17)},$.iras.displayErrorLiveChatMsg=function(){var e="";$.iras.checkAfterHours()?e="You may contact our live chat agents or call us at 1800-356-8300 during office hours from 8am to 5pm.":e='Please click <span style="cursor: pointer; text-decoration: underline" onclick="$.iras.checkTokenLC(\''+$.iras.getIITSession($.iras.IIT_sess_name)+"');\">here</span> to chat with our live chat agents.";return e},bindBtnRequestForm=function(l,c,d,a,i){$("div.speech-bubble1:last").on("click",".btnRequestForm",function(){var r=$(this).data("request-type"),e={SessionID:a,UserID:l.toUpperCase(),RequestType:r+"||"+c,TaxType:"IIT"},o="";if($(".load").css("display","block"),3==r)var t="Request for annex";else if(2==r)t="Request for tax form";$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble"><b>You clicked:</b><br/>'+t+"</div>"),$.ajax({url:i?"//stage4a.flexanswer.com/cfp8.0/va/IRAS/js/uat/request_tax_form.json":$.iras.IIT_req_url,data:i?"":JSON.stringify(e),method:i?"GET":"POST",contentType:"text/plain",success:function(e){if($(".load").css("display","none"),"string"==typeof e){if("no token"===e.toLowerCase())return $.iras.showTimeoutMessage(l,c,d),$.iras.disableIITForm($(".avatar_content > ul > li:last").find("form.iit-form:last")),$.iras.disableSpLogout(),G(),void Q();e=(e=e.replace(/\'/g,'"')).replace(/\\/g,"")}if("object"!=typeof e)var t=JSON.parse(e);else t=e;if(void 0===(a=t.data.status))var a=t.data.Status;var i=parseInt(t.returnCode);if(-1!==a.toLowerCase().indexOf("success"))switch(i){case 10:if(2==r)o+="<p>You will receive the tax form within 5 working days (for local address) and within 2-4 weeks (for overseas address).</p>";else{if(3!=r)break;o+="<p>You will receive the Annex within 5 working days (for local address) and within 2-4 weeks (for overseas address).</p>"}o+="<p>Please ensure your address is updated.",o+='<div style="margin-top: 8px; text-align: center; width: 100%">',o+="<button onclick=\"window.open('"+$.iras.updateDetailsUrl+'\');" type="button" class="btn-iit">Check / Update Address</button>',o+="</div></p>"}else{if(void 0===(s=parseInt(t.Info.messageCode)))var s=parseInt(t.info.messageCode);switch(s){case 850301:t.Info.fieldInfoList[0].field,t.Info.fieldInfoList[0].message;o+="<p>Sorry, there is an error with your request. Please try again with a different set of information.</p>";break;case 850302:case 850303:case 850304:o+="<p>Sorry, there is an error with your request. Please login again.</p>"}}if(1!=r){var n='<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says:</strong><span class="iit-checkbalance"><p>'+o+"</p></span></div>";$.iras.appendIITMsg(n)}}})})},$(".btnSpLogout").off().on("click",function(){$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble"><b>You clicked:</b><p>Logout</p></div>'),$.iras.appendIITMsg('<div class="VAclear"></div><div class="speech-bubble1"><strong class="va_says">Jamie says</strong><p>You have successfully logged out of SingPass.</p></div>'),$.iras.deleteIITSession($.iras.IIT_sess_name),$.iras.disableIITForm(),$("div.text_chat").find("button.btnSpLogout").off().remove(),0<$(".ui-tooltip").length&&$(".btnSpLogout").tooltip("destroy"),$(".send_button").removeAttr("style"),$(".send_button").attr("style","display: inline-block"),jQuery.browser.mobile&&$(".text_chat textarea").css("width","80%")})});